{
  "version": 4,
  "terraform_version": "0.12.23",
  "serial": 24,
  "lineage": "d724aa02-fb61-d71b-69a5-2a6d5af1a234",
  "outputs": {},
  "resources": [
    {
      "module": "module.versioning",
      "mode": "managed",
      "type": "aws_cloudformation_stack",
      "name": "s3versioningstack",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "capabilities": null,
            "disable_rollback": false,
            "iam_role_arn": "",
            "id": "arn:aws:cloudformation:us-west-1:465614246347:stack/s3versioningstack/c9479530-6bd1-11ea-9cd0-0654b762efd7",
            "name": "s3versioningstack",
            "notification_arns": null,
            "on_failure": null,
            "outputs": {},
            "parameters": {},
            "policy_body": null,
            "policy_url": null,
            "tags": null,
            "template_body": "{\"AWSTemplateFormatVersion\":\"2010-09-09\",\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"3336a676-a8b1-4c52-9e66-a5d65f60b9a2\":{\"embeds\":[],\"position\":{\"x\":150,\"y\":60},\"size\":{\"height\":60,\"width\":60},\"z\":1},\"bc4c9c12-fdf6-4da7-9787-acba4c5dd05a\":{\"dependson\":[\"3336a676-a8b1-4c52-9e66-a5d65f60b9a2\"],\"embeds\":[],\"position\":{\"x\":60,\"y\":150},\"size\":{\"height\":60,\"width\":60},\"z\":1},\"cb32f275-2404-4e7b-8e6a-c44e48d8ff0c\":{\"source\":{\"id\":\"bc4c9c12-fdf6-4da7-9787-acba4c5dd05a\"},\"target\":{\"id\":\"3336a676-a8b1-4c52-9e66-a5d65f60b9a2\"},\"z\":2}}},\"Resources\":{\"CCR4GCAY\":{\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"id\":\"3336a676-a8b1-4c52-9e66-a5d65f60b9a2\"}},\"Properties\":{\"ConfigRuleName\":\"s3versioning\",\"Description\":\"Enables versioning on s3 buckets\",\"Scope\":{\"ComplianceResourceTypes\":[\"AWS::S3::Bucket\"]},\"Source\":{\"Owner\":\"AWS\",\"SourceIdentifier\":\"S3_BUCKET_VERSIONING_ENABLED\"}},\"Type\":\"AWS::Config::ConfigRule\"},\"CRC1RSTS\":{\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"id\":\"bc4c9c12-fdf6-4da7-9787-acba4c5dd05a\"}},\"Properties\":{\"Automatic\":true,\"ConfigRuleName\":{\"Ref\":\"CCR4GCAY\"},\"MaximumAutomaticAttempts\":5,\"Parameters\":{\"AutomationAssumeRole\":{\"StaticValue\":{\"Values\":[\"arn:aws:iam::465614246347:role/AutomationRoleAWS\"]}},\"BucketName\":{\"ResourceValue\":{\"Value\":\"RESOURCE_ID\"}},\"VersioningState\":{\"StaticValue\":{\"Values\":[\"Enabled\"]}}},\"RetryAttemptSeconds\":60,\"TargetId\":\"AWS-ConfigureS3BucketVersioning\",\"TargetType\":\"SSM_DOCUMENT\"},\"Type\":\"AWS::Config::RemediationConfiguration\"}}}",
            "template_url": null,
            "timeout_in_minutes": null,
            "timeouts": null
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInVwZGF0ZSI6MTgwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "module": "module.encrypting",
      "mode": "managed",
      "type": "aws_cloudformation_stack",
      "name": "stack",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "capabilities": null,
            "disable_rollback": false,
            "iam_role_arn": "",
            "id": "arn:aws:cloudformation:us-west-1:465614246347:stack/s3encryptingstack/c93e1f50-6bd1-11ea-954f-024ef00267a9",
            "name": "s3encryptingstack",
            "notification_arns": null,
            "on_failure": null,
            "outputs": {},
            "parameters": {},
            "policy_body": null,
            "policy_url": null,
            "tags": null,
            "template_body": "{\"AWSTemplateFormatVersion\":\"2010-09-09\",\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"100635e3-fb53-48b1-80ab-62898b178be6\":{\"embeds\":[],\"position\":{\"x\":153,\"y\":111},\"size\":{\"height\":60,\"width\":60},\"z\":0},\"1d475480-04cc-498e-8864-eecbe59ac9a8\":{\"embeds\":[],\"position\":{\"x\":68,\"y\":27},\"size\":{\"height\":60,\"width\":60},\"z\":0}}},\"Resources\":{\"CCR29R40\":{\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"id\":\"1d475480-04cc-498e-8864-eecbe59ac9a8\"}},\"Properties\":{\"ConfigRuleName\":\"s3encrypting\",\"Description\":\"Enables server side encryption on s3 buckets\",\"Scope\":{\"ComplianceResourceTypes\":[\"AWS::S3::Bucket\"]},\"Source\":{\"Owner\":\"AWS\",\"SourceIdentifier\":\"S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED\"}},\"Type\":\"AWS::Config::ConfigRule\"},\"CRC4A2YE\":{\"Metadata\":{\"AWS::CloudFormation::Designer\":{\"id\":\"100635e3-fb53-48b1-80ab-62898b178be6\"}},\"Properties\":{\"Automatic\":true,\"ConfigRuleName\":{\"Ref\":\"CCR29R40\"},\"MaximumAutomaticAttempts\":5,\"Parameters\":{\"AutomationAssumeRole\":{\"StaticValue\":{\"Values\":[\"arn:aws:iam::465614246347:role/AwsAutomationRole\"]}},\"BucketName\":{\"ResourceValue\":{\"Value\":\"RESOURCE_ID\"}},\"SSEAlgorithm\":{\"StaticValue\":{\"Values\":[\"AES256\"]}}},\"RetryAttemptSeconds\":60,\"TargetId\":\"AWS-EnableS3BucketEncryption\",\"TargetType\":\"SSM_DOCUMENT\"},\"Type\":\"AWS::Config::RemediationConfiguration\"}}}",
            "template_url": null,
            "timeout_in_minutes": null,
            "timeouts": null
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInVwZGF0ZSI6MTgwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "AutomationRoleAWS",
      "provider": "module.iam.provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::465614246347:role/AutomationRoleAWS",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"ssm.amazonaws.com\",\"ec2.amazonaws.com\"]},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2020-03-22T00:12:15Z",
            "description": "",
            "force_detach_policies": false,
            "id": "AutomationRoleAWS",
            "max_session_duration": 3600,
            "name": "AutomationRoleAWS",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROAWY2GFSHFVJQAZDQYN"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "automation_policy",
      "provider": "module.iam.provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "AutomationRoleAWS:automation_policy",
            "name": "automation_policy",
            "name_prefix": null,
            "policy": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\"\n            ],\n            \"Resource\": [\n                \"arn:aws:lambda:*:*:function:Automation*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:CreateImage\",\n                \"ec2:CopyImage\",\n                \"ec2:DeregisterImage\",\n                \"ec2:DescribeImages\",\n                \"ec2:DeleteSnapshot\",\n                \"ec2:StartInstances\",\n                \"ec2:RunInstances\",\n                \"ec2:StopInstances\",\n                \"ec2:TerminateInstances\",\n                \"ec2:DescribeInstanceStatus\",\n                \"ec2:CreateTags\",\n                \"ec2:DeleteTags\",\n                \"ec2:DescribeTags\",\n                \"cloudformation:CreateStack\",\n                \"cloudformation:DescribeStackEvents\",\n                \"cloudformation:DescribeStacks\",\n                \"cloudformation:UpdateStack\",\n                \"cloudformation:DeleteStack\"\n            ],\n            \"Resource\": [\n                \"*\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ssm:*\"\n            ],\n            \"Resource\": [\n                \"*\"\n            ]\n        },\n        {\n          \"Effect\": \"Allow\",\n          \"Action\": \"s3:*\",\n          \"Resource\": \"*\"\n      },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"sns:Publish\"\n            ],\n            \"Resource\": [\n                \"arn:aws:sns:*:*:Automation*\"\n            ]\n        },\n        {\n          \"Sid\": \"VisualEditor0\",\n          \"Effect\": \"Allow\",\n          \"Action\": \"iam:PassRole\",\n          \"Resource\": \"arn:aws:iam::465614246347:role/arn:aws:iam::465614246347:role/AwsAutomationRole\"\n      }\n\n    ]\n}\n",
            "role": "AutomationRoleAWS"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_role.AutomationRoleAWS"
          ]
        }
      ]
    }
  ]
}
